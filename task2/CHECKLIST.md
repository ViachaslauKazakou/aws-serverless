# ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è Task 2

## üìã –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞

- [ ] AWS CLI —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω (`aws --version`)
- [ ] Credentials –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
- [ ] –î–æ—Å—Ç—É–ø –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É –µ—Å—Ç—å
- [ ] Region —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –Ω–∞ `eu-west-1`
- [ ] jq —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è JSON)

## üéØ –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏ (2 moves)

### Move 1: –°–æ–∑–¥–∞—Ç—å Inline Policy –¥–ª—è —Ä–æ–ª–∏
- [ ] –°–æ–∑–¥–∞–Ω —Ñ–∞–π–ª `inline-policy.json`
- [ ] JSON —Å–∏–Ω—Ç–∞–∫—Å–∏—Å –∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω
- [ ] Action: `s3:ListAllMyBuckets`
- [ ] Resource: `*`
- [ ] Effect: `Allow`
- [ ] –í—ã–ø–æ–ª–Ω–µ–Ω–∞ –∫–æ–º–∞–Ω–¥–∞ `put-role-policy`
- [ ] Policy Name: `ListAllBucketsPolicy`
- [ ] Role Name: `cmtr-4n6e9j62-iam-pela-iam_role`
- [ ] –ö–æ–º–∞–Ω–¥–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ (–Ω–µ—Ç –æ—à–∏–±–æ–∫)
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ `list-role-policies`

**–ö–æ–º–∞–Ω–¥–∞:**
```bash
aws iam put-role-policy \
    --role-name cmtr-4n6e9j62-iam-pela-iam_role \
    --policy-name ListAllBucketsPolicy \
    --policy-document file://inline-policy.json
```

### Move 2: –°–æ–∑–¥–∞—Ç—å Bucket Policy –¥–ª—è bucket-1
- [ ] –°–æ–∑–¥–∞–Ω —Ñ–∞–π–ª `bucket-policy.json`
- [ ] JSON —Å–∏–Ω—Ç–∞–∫—Å–∏—Å –∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω
- [ ] Principal ARN –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π
- [ ] Actions —É–∫–∞–∑–∞–Ω—ã: `GetObject`, `PutObject`, `ListBucket`
- [ ] Resource ARN –¥–ª—è bucket —É–∫–∞–∑–∞–Ω (–±–µ–∑ /*)
- [ ] Resource ARN –¥–ª—è –æ–±—ä–µ–∫—Ç–æ–≤ —É–∫–∞–∑–∞–Ω (—Å /*)
- [ ] Effect: `Allow`
- [ ] –í—ã–ø–æ–ª–Ω–µ–Ω–∞ –∫–æ–º–∞–Ω–¥–∞ `put-bucket-policy`
- [ ] Bucket Name: `cmtr-4n6e9j62-iam-pela-bucket-1-162653`
- [ ] –ö–æ–º–∞–Ω–¥–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ (–Ω–µ—Ç –æ—à–∏–±–æ–∫)
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ `get-bucket-policy`
- [ ] **Bucket-2 –ù–ï –¢–†–û–ì–ê–õ–ò** ‚ö†Ô∏è

**–ö–æ–º–∞–Ω–¥–∞:**
```bash
aws s3api put-bucket-policy \
    --bucket cmtr-4n6e9j62-iam-pela-bucket-1-162653 \
    --policy file://bucket-policy.json
```

## ‚úÖ –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è

### –ü—Ä–æ–≤–µ—Ä–∫–∞ 1: ListAllMyBuckets (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å allowed)
- [ ] –í—ã–ø–æ–ª–Ω–µ–Ω–∞ —Å–∏–º—É–ª—è—Ü–∏—è —á–µ—Ä–µ–∑ CLI –∏–ª–∏ Web UI
- [ ] Action: `s3:ListAllMyBuckets`
- [ ] –†–µ–∑—É–ª—å—Ç–∞—Ç: `"EvalDecision": "allowed"` ‚úÖ

**–ö–æ–º–∞–Ω–¥–∞:**
```bash
aws iam simulate-principal-policy \
  --policy-source-arn arn:aws:iam::863518426750:role/cmtr-4n6e9j62-iam-pela-iam_role \
  --action-names s3:ListAllMyBuckets
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ 2: ListBucket –¥–ª—è bucket-1 (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å allowed)
- [ ] –í—ã–ø–æ–ª–Ω–µ–Ω–∞ —Å–∏–º—É–ª—è—Ü–∏—è
- [ ] Action: `s3:ListBucket`
- [ ] Resource: `arn:aws:s3:::cmtr-4n6e9j62-iam-pela-bucket-1-162653`
- [ ] –†–µ–∑—É–ª—å—Ç–∞—Ç: `"EvalDecision": "allowed"` ‚úÖ

### –ü—Ä–æ–≤–µ—Ä–∫–∞ 3: GetObject –¥–ª—è bucket-1 (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å allowed)
- [ ] –í—ã–ø–æ–ª–Ω–µ–Ω–∞ —Å–∏–º—É–ª—è—Ü–∏—è
- [ ] Action: `s3:GetObject`
- [ ] Resource: `arn:aws:s3:::cmtr-4n6e9j62-iam-pela-bucket-1-162653/*`
- [ ] –†–µ–∑—É–ª—å—Ç–∞—Ç: `"EvalDecision": "allowed"` ‚úÖ

### –ü—Ä–æ–≤–µ—Ä–∫–∞ 4: PutObject –¥–ª—è bucket-1 (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å allowed)
- [ ] –í—ã–ø–æ–ª–Ω–µ–Ω–∞ —Å–∏–º—É–ª—è—Ü–∏—è
- [ ] Action: `s3:PutObject`
- [ ] Resource: `arn:aws:s3:::cmtr-4n6e9j62-iam-pela-bucket-1-162653/*`
- [ ] –†–µ–∑—É–ª—å—Ç–∞—Ç: `"EvalDecision": "allowed"` ‚úÖ

### –ü—Ä–æ–≤–µ—Ä–∫–∞ 5: ListBucket –¥–ª—è bucket-2 (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å implicitDeny)
- [ ] –í—ã–ø–æ–ª–Ω–µ–Ω–∞ —Å–∏–º—É–ª—è—Ü–∏—è
- [ ] Action: `s3:ListBucket`
- [ ] Resource: `arn:aws:s3:::cmtr-4n6e9j62-iam-pela-bucket-2-162653`
- [ ] –†–µ–∑—É–ª—å—Ç–∞—Ç: `"EvalDecision": "implicitDeny"` ‚ùå ‚úÖ

### –ü—Ä–æ–≤–µ—Ä–∫–∞ 6: GetObject –¥–ª—è bucket-2 (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å implicitDeny)
- [ ] –í—ã–ø–æ–ª–Ω–µ–Ω–∞ —Å–∏–º—É–ª—è—Ü–∏—è
- [ ] Action: `s3:GetObject`
- [ ] Resource: `arn:aws:s3:::cmtr-4n6e9j62-iam-pela-bucket-2-162653/*`
- [ ] –†–µ–∑—É–ª—å—Ç–∞—Ç: `"EvalDecision": "implicitDeny"` ‚ùå ‚úÖ

### –ü—Ä–æ–≤–µ—Ä–∫–∞ 7: PutObject –¥–ª—è bucket-2 (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å implicitDeny)
- [ ] –í—ã–ø–æ–ª–Ω–µ–Ω–∞ —Å–∏–º—É–ª—è—Ü–∏—è
- [ ] Action: `s3:PutObject`
- [ ] Resource: `arn:aws:s3:::cmtr-4n6e9j62-iam-pela-bucket-2-162653/*`
- [ ] –†–µ–∑—É–ª—å—Ç–∞—Ç: `"EvalDecision": "implicitDeny"` ‚ùå ‚úÖ

## üìä –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

### –ú–∞—Ç—Ä–∏—Ü–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π:

| –î–µ–π—Å—Ç–≤–∏–µ | Bucket-1 | Bucket-2 | –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ |
|----------|----------|----------|-----------|
| s3:ListAllMyBuckets | ‚úÖ ALLOW | ‚úÖ ALLOW | [ ] |
| s3:ListBucket | ‚úÖ ALLOW | ‚ùå DENY | [ ] |
| s3:GetObject | ‚úÖ ALLOW | ‚ùå DENY | [ ] |
| s3:PutObject | ‚úÖ ALLOW | ‚ùå DENY | [ ] |

### –ü–æ–ª–∏—Ç–∏–∫–∏ –Ω–∞ –º–µ—Å—Ç–µ:

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –ü–æ–ª–∏—Ç–∏–∫–∞ | –°—Ç–∞—Ç—É—Å |
|-----------|----------|--------|
| IAM Role | Inline Policy: ListAllBucketsPolicy | [ ] |
| S3 Bucket-1 | Bucket Policy: Allow Get/Put/List | [ ] |
| S3 Bucket-2 | NO POLICY (–æ—Å—Ç–∞–≤–∏—Ç—å –ø—É—Å—Ç—ã–º!) | [ ] |

## üéØ –ò—Ç–æ–≥–æ–≤–∞—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è

- [ ] –ó–∞–¥–∞—á–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ –∑–∞ **2 moves** (–Ω–µ –±–æ–ª—å—à–µ)
- [ ] –†–æ–ª—å –º–æ–∂–µ—Ç –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö buckets
- [ ] –†–æ–ª—å –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å –æ–±—ä–µ–∫—Ç–∞–º–∏ –≤ bucket-1
- [ ] –†–æ–ª—å –ù–ï –ú–û–ñ–ï–¢ —Ä–∞–±–æ—Ç–∞—Ç—å —Å –æ–±—ä–µ–∫—Ç–∞–º–∏ –≤ bucket-2
- [ ] Bucket-2 –Ω–µ –∏–º–µ–µ—Ç –Ω–∏–∫–∞–∫–∏—Ö –ø–æ–ª–∏—Ç–∏–∫
- [ ] –í—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–æ–π–¥–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ
- [ ] –ù–µ—Ç –æ—à–∏–±–æ–∫ –≤ –ª–æ–≥–∞—Ö

## üìù –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏

- [ ] Inline policy –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ –∫–æ–Ω—Å–æ–ª–∏ IAM
- [ ] Bucket policy –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ –∫–æ–Ω—Å–æ–ª–∏ S3
- [ ] Bucket-2 –ù–ï –∏–º–µ–µ—Ç –ø–æ–ª–∏—Ç–∏–∫–∏ (–ø—Ä–æ–≤–µ—Ä–µ–Ω–æ)
- [ ] Policy Simulator –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

## üêõ Troubleshooting (–µ—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫)

### –ï—Å–ª–∏ –∫–æ–º–∞–Ω–¥–∞ put-role-policy –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å JSON —Å–∏–Ω—Ç–∞–∫—Å–∏—Å (`cat inline-policy.json | jq '.'`)
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ —Ä–æ–ª–∏
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –∏–º–µ–Ω–∏ —Ä–æ–ª–∏
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–≤–∞ —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### –ï—Å–ª–∏ –∫–æ–º–∞–Ω–¥–∞ put-bucket-policy –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å JSON —Å–∏–Ω—Ç–∞–∫—Å–∏—Å
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ–±–∞ Resource ARN (—Å /* –∏ –±–µ–∑ /*)
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Principal ARN
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ bucket
- [ ] –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ —ç—Ç–æ bucket-1, –∞ –Ω–µ bucket-2!

### –ï—Å–ª–∏ Policy Simulator –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:
- [ ] –ü–æ–¥–æ–∂–¥–∞—Ç—å 1-2 –º–∏–Ω—É—Ç—ã (–ø–æ–ª–∏—Ç–∏–∫–∏ –º–æ–≥—É—Ç –ø—Ä–∏–º–µ–Ω—è—Ç—å—Å—è —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π)
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å Resource ARN
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å Action name
- [ ] –û—á–∏—Å—Ç–∏—Ç—å –∫—ç—à –±—Ä–∞—É–∑–µ—Ä–∞ (–¥–ª—è Web UI)
- [ ] –ü–æ–≤—Ç–æ—Ä–∏—Ç—å —Ç–µ—Å—Ç

### –ï—Å–ª–∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–ª—è bucket-2 –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç allowed:
- [ ] **–ü–†–û–ë–õ–ï–ú–ê!** Bucket-2 –Ω–µ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –¥–æ—Å—Ç—É–ø–µ–Ω
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –Ω–µ —Å–æ–∑–¥–∞–ª–∏ –ª–∏ –ø–æ–ª–∏—Ç–∏–∫—É –¥–ª—è bucket-2 –ø–æ –æ—à–∏–±–∫–µ
- [ ] –£–¥–∞–ª–∏—Ç—å –ø–æ–ª–∏—Ç–∏–∫—É –∏–∑ bucket-2, –µ—Å–ª–∏ —Å–æ–∑–¥–∞–Ω–∞
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ Principal ARN –≤ bucket policy —É–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ –Ω–∞ bucket-1

## üìû –ì–¥–µ –∏—Å–∫–∞—Ç—å –ø–æ–º–æ—â—å

- [ ] FAQ.md - —á–∞—Å—Ç–æ –∑–∞–¥–∞–≤–∞–µ–º—ã–µ –≤–æ–ø—Ä–æ—Å—ã
- [ ] TESTING.md - troubleshooting —Å–µ–∫—Ü–∏—è
- [ ] INSTRUCTIONS.md - –¥–µ—Ç–∞–ª—å–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏
- [ ] ARCHITECTURE.md - —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∞—è –±–∞–∑–∞

## üéì –ü–æ–Ω–∏–º–∞–Ω–∏–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–π

- [ ] –ü–æ–Ω–∏–º–∞—é —Ä–∞–∑–Ω–∏—Ü—É –º–µ–∂–¥—É Inline –∏ Managed policies
- [ ] –ü–æ–Ω–∏–º–∞—é, –∫–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Inline policy
- [ ] –ü–æ–Ω–∏–º–∞—é, –∫–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç Bucket Policy
- [ ] –ü–æ–Ω–∏–º–∞—é —Ä–∞–∑–Ω–∏—Ü—É –º–µ–∂–¥—É Resource ARN —Å /* –∏ –±–µ–∑ /*
- [ ] –ü–æ–Ω–∏–º–∞—é –∫–æ–Ω—Ü–µ–ø—Ü–∏—é Implicit Deny
- [ ] –ü–æ–Ω–∏–º–∞—é, –∫–∞–∫ –∫–æ–º–±–∏–Ω–∏—Ä—É—é—Ç—Å—è Identity –∏ Resource policies

## üéâ –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ

–ï—Å–ª–∏ –≤—Å–µ —á–µ–∫–±–æ–∫—Å—ã –æ—Ç–º–µ—á–µ–Ω—ã, –ø–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! üéä

–í—ã —É—Å–ø–µ—à–Ω–æ:
- ‚úÖ –°–æ–∑–¥–∞–ª–∏ Inline Policy –¥–ª—è —Ä–æ–ª–∏
- ‚úÖ –°–æ–∑–¥–∞–ª–∏ Bucket Policy –¥–ª—è bucket-1
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–∏–ª–∏ –≥—Ä–∞–Ω—É–ª—è—Ä–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø–∞
- ‚úÖ –ò–∑—É—á–∏–ª–∏ –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª–∏—Ç–∏–∫
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏–ª–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç —á–µ—Ä–µ–∑ Policy Simulator

---

**–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** ~2-5 –º–∏–Ω—É—Ç  
**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** –°—Ä–µ–¥–Ω—è—è-–í—ã—Å–æ–∫–∞—è  
**Moves –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ:** 2 –∏–∑ 2  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ COMPLETED
