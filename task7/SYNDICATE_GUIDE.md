# –°–æ–∑–¥–∞–Ω–∏–µ Lambda —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Syndicate Framework

## –ß—Ç–æ —Ç–∞–∫–æ–µ Syndicate?

**Syndicate** ‚Äî —ç—Ç–æ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏ –¥–µ–ø–ª–æ—è serverless –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –Ω–∞ AWS. –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:

- üöÄ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ AWS —Ä–µ—Å—É—Ä—Å–æ–≤
- üì¶ –£–ø—Ä–æ—â–µ–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏ (pip, npm)
- üèóÔ∏è –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–∞–∫ –∫–æ–¥ (IaC)
- üîÑ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–µ—Ä—Å–∏—è–º–∏ –∏ rollback
- üß™ –í—Å—Ç—Ä–æ–µ–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- üìù –ê–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Syndicate

### Prerequisites

```bash
# Python 3.8+
python3 --version

# AWS CLI configured
aws configure list

# pip –∏–ª–∏ pipenv
pip3 --version
```

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —á–µ—Ä–µ–∑ pip

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ syndicate
pip3 install aws-syndicate

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏
syndicate --version
```

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —á–µ—Ä–µ–∑ pipenv (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```bash
# –°–æ–∑–¥–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
mkdir ~/my-syndicate-project
cd ~/my-syndicate-project

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å pipenv
pip3 install pipenv

# –°–æ–∑–¥–∞—Ç—å –æ–∫—Ä—É–∂–µ–Ω–∏–µ –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å syndicate
pipenv install aws-syndicate

# –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –æ–∫—Ä—É–∂–µ–Ω–∏–µ
pipenv shell
```

## –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ Syndicate

### –®–∞–≥ 1: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞

```bash
# –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç
syndicate generate project \
    --name task7-contacts-api \
    --region eu-west-1

cd task7-contacts-api
```

–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞:

```
task7-contacts-api/
‚îú‚îÄ‚îÄ deployment_resources.json    # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤ AWS
‚îú‚îÄ‚îÄ syndicate.yml               # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ Syndicate
‚îú‚îÄ‚îÄ syndicate_aliases.yml       # –ê–ª–∏–∞—Å—ã –∫–æ–º–∞–Ω–¥
‚îú‚îÄ‚îÄ src/                        # –ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ Lambda
‚îÇ   ‚îî‚îÄ‚îÄ lambdas/
‚îÇ       ‚îî‚îÄ‚îÄ hello_world/
‚îÇ           ‚îî‚îÄ‚îÄ handler.py
‚îî‚îÄ‚îÄ tests/                      # –¢–µ—Å—Ç—ã
    ‚îî‚îÄ‚îÄ test_hello_world.py
```

### –®–∞–≥ 2: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

**syndicate.yml** ‚Äî –≥–ª–∞–≤–Ω—ã–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª:

```yaml
# syndicate.yml
project_path: .
project_name: task7-contacts-api
resources_suffix: dev
deploy_target_bucket: syndicate-artifacts-${account_id}-${region}
deploy_target_bucket_region: eu-west-1

# –ê–ª–∏–∞—Å –¥–ª—è AWS credentials
credentials_aliases:
  - task7-dev

# –†–µ–≥–∏–æ–Ω—ã –¥–ª—è –¥–µ–ø–ª–æ—è
regions:
  - eu-west-1

# Build configurations
build_projects_mapping:
  python:
    - src/lambdas
```

**–°–æ–∑–¥–∞—Ç—å AWS credentials alias:**

```bash
# –°–æ–∑–¥–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –¥–ª—è syndicate
syndicate create_deploy_target_bucket \
    --bundle_name task7-contacts-api \
    --deploy_target_bucket syndicate-artifacts-418272778502-eu-west-1 \
    --region eu-west-1 \
    --credentials_alias task7-dev
```

## –°–æ–∑–¥–∞–Ω–∏–µ Lambda —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è Contacts API

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ Lambda

```bash
# –°–æ–∑–¥–∞—Ç—å –ø–∞–ø–∫—É –¥–ª—è Lambda
mkdir -p src/lambdas/contacts_api
cd src/lambdas/contacts_api
```

### handler.py - –∫–æ–¥ Lambda

```python
# src/lambdas/contacts_api/handler.py

import json
import os
from syndicate.core.helper.decorators import lambda_handler

# –î–µ–∫–æ—Ä–∞—Ç–æ—Ä @lambda_handler –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ª–æ–≥–∏—Ä—É–µ—Ç —Å–æ–±—ã—Ç–∏—è
@lambda_handler()
def lambda_handler(event, context):
    """
    Lambda handler for Contacts API
    Supports GET /contacts endpoint
    """
    
    # Mock –¥–∞–Ω–Ω—ã–µ contacts
    contacts = [
        {
            "id": 1,
            "name": "Elma Herring",
            "email": "elmaherring@conjurica.com",
            "phone": "+1 (866) 456-2052"
        },
        {
            "id": 2,
            "name": "Bell Burgess",
            "email": "bellburgess@conjurica.com",
            "phone": "+1 (934) 520-2048"
        },
        {
            "id": 3,
            "name": "Hobbs Ferrell",
            "email": "hobbsferrell@conjurica.com",
            "phone": "+1 (948) 527-2232"
        }
    ]
    
    # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ø–∞–¥–∞–µ—Ç –≤ CloudWatch)
    print(f"Received event: {json.dumps(event)}")
    
    # API Gateway HTTP API Payload Format 2.0
    http_method = event.get('requestContext', {}).get('http', {}).get('method')
    path = event.get('rawPath', '/')
    
    # –û–±—Ä–∞–±–æ—Ç–∫–∞ GET /contacts
    if http_method == 'GET' and path == '/contacts':
        return {
            'statusCode': 200,
            'headers': {
                'Content-Type': 'application/json',
                'Access-Control-Allow-Origin': '*'
            },
            'body': json.dumps(contacts)
        }
    
    # –û–±—Ä–∞–±–æ—Ç–∫–∞ GET /contacts/{id}
    if http_method == 'GET' and path.startswith('/contacts/'):
        contact_id = int(path.split('/')[-1])
        contact = next((c for c in contacts if c['id'] == contact_id), None)
        
        if contact:
            return {
                'statusCode': 200,
                'headers': {
                    'Content-Type': 'application/json',
                    'Access-Control-Allow-Origin': '*'
                },
                'body': json.dumps(contact)
            }
        else:
            return {
                'statusCode': 404,
                'headers': {'Content-Type': 'application/json'},
                'body': json.dumps({'error': 'Contact not found'})
            }
    
    # Route –Ω–µ –Ω–∞–π–¥–µ–Ω
    return {
        'statusCode': 404,
        'headers': {'Content-Type': 'application/json'},
        'body': json.dumps({'error': 'Not Found'})
    }
```

### requirements.txt - –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

```txt
# src/lambdas/contacts_api/requirements.txt

# Syndicate runtime helpers
aws-syndicate>=1.0.0

# Optional: —Ä–∞–±–æ—Ç–∞ —Å –¥–∞–Ω–Ω—ã–º–∏
# boto3  # —É–∂–µ –≤–∫–ª—é—á–µ–Ω –≤ Lambda runtime
# requests
```

### lambda_config.json - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Lambda

```json
{
  "lambda-config": {
    "contacts_api": {
      "name": "cmtr-4n6e9j62-api-gwlp-lambda-contacts",
      "runtime": "python3.9",
      "memory": 512,
      "timeout": 30,
      "publish": true,
      "alias": "dev",
      "env_variables": {
        "ENVIRONMENT": "development",
        "LOG_LEVEL": "INFO"
      },
      "iam_role_name": "contacts-api-lambda-role",
      "resource_type": "lambda"
    }
  }
}
```

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è IAM Role

### deployment_resources.json

```json
{
  "lambda_iam_roles": {
    "contacts-api-lambda-role": {
      "predefined_policies": [
        "AWSLambdaBasicExecutionRole"
      ],
      "trusted_service": [
        "lambda"
      ],
      "custom_policies": []
    }
  }
}
```

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è API Gateway

–î–æ–±–∞–≤–∏—Ç—å –≤ **deployment_resources.json**:

```json
{
  "api_gateway_v2": {
    "task7-contacts-api": {
      "name": "task7-contacts-api",
      "protocol_type": "HTTP",
      "cors_configuration": {
        "allow_origins": ["*"],
        "allow_methods": ["GET", "POST", "DELETE", "OPTIONS"],
        "allow_headers": ["Content-Type", "Authorization"],
        "max_age": 3600
      },
      "routes": [
        {
          "route_key": "GET /contacts",
          "target": {
            "integration_type": "AWS_PROXY",
            "lambda": "contacts_api"
          }
        },
        {
          "route_key": "GET /contacts/{id}",
          "target": {
            "integration_type": "AWS_PROXY",
            "lambda": "contacts_api"
          }
        }
      ],
      "deploy_stage": "$default",
      "auto_deploy": true
    }
  }
}
```

## –ü–æ–ª–Ω—ã–π deployment_resources.json

```json
{
  "lambda_iam_roles": {
    "contacts-api-lambda-role": {
      "predefined_policies": [
        "AWSLambdaBasicExecutionRole"
      ],
      "trusted_service": [
        "lambda"
      ],
      "custom_policies": []
    }
  },
  
  "lambda": {
    "contacts_api": {
      "name": "cmtr-4n6e9j62-api-gwlp-lambda-contacts",
      "runtime": "python3.9",
      "memory": 512,
      "timeout": 30,
      "publish": true,
      "alias": "dev",
      "env_variables": {
        "ENVIRONMENT": "development",
        "LOG_LEVEL": "INFO"
      },
      "iam_role_name": "contacts-api-lambda-role",
      "resource_type": "lambda"
    }
  },
  
  "api_gateway_v2": {
    "task7-contacts-api": {
      "name": "task7-contacts-api",
      "protocol_type": "HTTP",
      "cors_configuration": {
        "allow_origins": ["*"],
        "allow_methods": ["GET", "POST", "DELETE", "OPTIONS"],
        "allow_headers": ["Content-Type", "Authorization"],
        "max_age": 3600
      },
      "routes": [
        {
          "route_key": "GET /contacts",
          "target": {
            "integration_type": "AWS_PROXY",
            "lambda": "contacts_api"
          }
        },
        {
          "route_key": "GET /contacts/{id}",
          "target": {
            "integration_type": "AWS_PROXY",
            "lambda": "contacts_api"
          }
        },
        {
          "route_key": "POST /contacts",
          "target": {
            "integration_type": "AWS_PROXY",
            "lambda": "contacts_api"
          }
        },
        {
          "route_key": "DELETE /contacts/{id}",
          "target": {
            "integration_type": "AWS_PROXY",
            "lambda": "contacts_api"
          }
        }
      ],
      "deploy_stage": "$default",
      "auto_deploy": true
    }
  }
}
```

## –ö–æ–º–∞–Ω–¥—ã Syndicate

### Build –ø—Ä–æ–µ–∫—Ç–∞

```bash
# –°–æ–±—Ä–∞—Ç—å –≤—Å–µ Lambda —Ñ—É–Ω–∫—Ü–∏–∏
syndicate build

# Build —Å–æ–∑–¥–∞—Å—Ç .syndicate –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é —Å –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–∞–º–∏
```

### Deploy –Ω–∞ AWS

```bash
# –ü–µ—Ä–≤—ã–π deploy
syndicate deploy \
    --bundle_name task7-contacts-api-v1 \
    --deploy_target_bucket syndicate-artifacts-418272778502-eu-west-1

# Syndicate –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
# 1. –°–æ–∑–¥–∞—Å—Ç IAM —Ä–æ–ª—å
# 2. –ó–∞–≥—Ä—É–∑–∏—Ç Lambda –∫–æ–¥ –≤ S3
# 3. –°–æ–∑–¥–∞—Å—Ç Lambda —Ñ—É–Ω–∫—Ü–∏—é
# 4. –°–æ–∑–¥–∞—Å—Ç API Gateway
# 5. –ù–∞—Å—Ç—Ä–æ–∏—Ç Integration
# 6. –î–æ–±–∞–≤–∏—Ç Lambda Permission
# 7. Deploy API Gateway
```

### Update —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –¥–µ–ø–ª–æ—è

```bash
# –û–±–Ω–æ–≤–∏—Ç—å Lambda –∫–æ–¥
syndicate update \
    --bundle_name task7-contacts-api-v1 \
    --deploy_target_bucket syndicate-artifacts-418272778502-eu-west-1
```

### –ü—Ä–æ—Å–º–æ—Ç—Ä –¥–µ–ø–ª–æ–µ–≤

```bash
# –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –¥–µ–ø–ª–æ–µ–≤
syndicate list_deploy_resources \
    --bundle_name task7-contacts-api-v1

# –î–µ—Ç–∞–ª–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –¥–µ–ø–ª–æ—è
syndicate describe_deploy_resources \
    --bundle_name task7-contacts-api-v1
```

### –£–¥–∞–ª–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤

```bash
# –ü–æ–ª–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –≤—Å–µ—Ö —Ä–µ—Å—É—Ä—Å–æ–≤
syndicate clean \
    --bundle_name task7-contacts-api-v1 \
    --deploy_target_bucket syndicate-artifacts-418272778502-eu-west-1

# Syndicate —É–¥–∞–ª–∏—Ç:
# - API Gateway
# - Lambda —Ñ—É–Ω–∫—Ü–∏—é
# - IAM —Ä–æ–ª—å
# - CloudWatch Logs
```

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –õ–æ–∫–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# –°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤–æ–µ —Å–æ–±—ã—Ç–∏–µ
cat > test_event.json <<EOF
{
  "version": "2.0",
  "routeKey": "GET /contacts",
  "rawPath": "/contacts",
  "requestContext": {
    "http": {
      "method": "GET",
      "path": "/contacts"
    }
  }
}
EOF

# –ó–∞–ø—É—Å—Ç–∏—Ç—å Lambda –ª–æ–∫–∞–ª—å–Ω–æ (–µ—Å–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω SAM)
sam local invoke contacts_api -e test_event.json
```

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ AWS

```bash
# –ü–æ—Å–ª–µ deploy –ø–æ–ª—É—á–∏—Ç—å API endpoint
API_ENDPOINT=$(aws apigatewayv2 get-apis \
    --query "Items[?Name=='task7-contacts-api'].ApiEndpoint" \
    --output text)

# –¢–µ—Å—Ç–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å
curl $API_ENDPOINT/contacts

# –û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç:
# [{"id": 1, "name": "Elma Herring", ...}]
```

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

```bash
# CloudWatch Logs
aws logs tail /aws/lambda/cmtr-4n6e9j62-api-gwlp-lambda-contacts --follow

# –ú–µ—Ç—Ä–∏–∫–∏ Lambda
aws cloudwatch get-metric-statistics \
    --namespace AWS/Lambda \
    --metric-name Invocations \
    --dimensions Name=FunctionName,Value=cmtr-4n6e9j62-api-gwlp-lambda-contacts \
    --statistics Sum \
    --start-time 2024-01-01T00:00:00Z \
    --end-time 2024-01-02T00:00:00Z \
    --period 3600
```

## CI/CD –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

### GitHub Actions

```yaml
# .github/workflows/deploy.yml
name: Deploy to AWS

on:
  push:
    branches: [main]

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      
      - name: Setup Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.9'
      
      - name: Install Syndicate
        run: pip install aws-syndicate
      
      - name: Configure AWS
        uses: aws-actions/configure-aws-credentials@v2
        with:
          aws-access-key-id: ${{ secrets.AWS_ACCESS_KEY_ID }}
          aws-secret-access-key: ${{ secrets.AWS_SECRET_ACCESS_KEY }}
          aws-region: eu-west-1
      
      - name: Build
        run: syndicate build
      
      - name: Deploy
        run: |
          syndicate deploy \
            --bundle_name task7-contacts-api-${{ github.sha }} \
            --deploy_target_bucket syndicate-artifacts-418272778502-eu-west-1
```

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ Syndicate vs AWS CLI

| –ê—Å–ø–µ–∫—Ç | AWS CLI | Syndicate |
|--------|---------|-----------|
| **–î–µ–ø–ª–æ–π** | –†—É—á–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã | –û–¥–Ω–∞ –∫–æ–º–∞–Ω–¥–∞ |
| **–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏** | –í—Ä—É—á–Ω—É—é —É–ø–∞–∫–æ–≤—ã–≤–∞—Ç—å | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ |
| **IAM Roles** | –°–æ–∑–¥–∞–≤–∞—Ç—å –≤—Ä—É—á–Ω—É—é | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ |
| **–í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ** | –°–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ | –í—Å—Ç—Ä–æ–µ–Ω–æ |
| **Rollback** | –°–ª–æ–∂–Ω–æ | `syndicate rollback` |
| **API Gateway** | –ú–Ω–æ–∂–µ—Å—Ç–≤–æ –∫–æ–º–∞–Ω–¥ | –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤ JSON |
| **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** | AWS Console | –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã |
| **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** | –û—Ç–¥–µ–ª—å–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã | –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–æ |

## Best Practices

### 1. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
project/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ lambdas/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ contacts_api/         # –û—Ç–¥–µ–ª—å–Ω–∞—è –ø–∞–ø–∫–∞ –¥–ª—è –∫–∞–∂–¥–æ–π Lambda
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ handler.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ requirements.txt
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ tests/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ auth/
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ handler.py
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ requirements.txt
‚îÇ   ‚îî‚îÄ‚îÄ layers/                   # Lambda Layers
‚îÇ       ‚îî‚îÄ‚îÄ common/
‚îú‚îÄ‚îÄ deployment_resources.json     # –í—Å—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞
‚îú‚îÄ‚îÄ syndicate.yml
‚îî‚îÄ‚îÄ tests/
```

### 2. Environment Variables

```json
{
  "lambda": {
    "contacts_api": {
      "env_variables": {
        "ENVIRONMENT": "${env:ENVIRONMENT}",
        "DB_HOST": "${ssm:/task7/db/host}",
        "API_KEY": "${secrets:/task7/api/key}"
      }
    }
  }
}
```

### 3. Layers –¥–ª—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```json
{
  "lambda_layer": {
    "common_layer": {
      "deployment_package": "layers/common",
      "runtimes": ["python3.9"],
      "architectures": ["x86_64"]
    }
  },
  "lambda": {
    "contacts_api": {
      "layers": ["common_layer"]
    }
  }
}
```

### 4. Alarms –∏ Monitoring

```json
{
  "cloudwatch_alarm": {
    "contacts-api-errors": {
      "metric_name": "Errors",
      "namespace": "AWS/Lambda",
      "statistic": "Sum",
      "period": 300,
      "evaluation_periods": 1,
      "threshold": 10,
      "comparison_operator": "GreaterThanThreshold",
      "dimensions": {
        "FunctionName": "contacts_api"
      }
    }
  }
}
```

## Troubleshooting

### –ü—Ä–æ–±–ª–µ–º–∞: Build fails

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–∏–Ω—Ç–∞–∫—Å–∏—Å Python
python3 -m py_compile src/lambdas/contacts_api/handler.py

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
pip install -r src/lambdas/contacts_api/requirements.txt
```

### –ü—Ä–æ–±–ª–µ–º–∞: Deploy fails

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å AWS credentials
aws sts get-caller-identity

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å S3 bucket
aws s3 ls s3://syndicate-artifacts-418272778502-eu-west-1

# Verbose mode
syndicate deploy --verbose
```

### –ü—Ä–æ–±–ª–µ–º–∞: Lambda timeout

```json
{
  "lambda": {
    "contacts_api": {
      "timeout": 60,  // –£–≤–µ–ª–∏—á–∏—Ç—å –¥–æ 60 —Å–µ–∫—É–Ω–¥
      "memory": 1024  // –ë–æ–ª—å—à–µ –ø–∞–º—è—Ç–∏ = –±—ã—Å—Ç—Ä–µ–µ CPU
    }
  }
}
```

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- üìö [Syndicate Documentation](https://github.com/epam/aws-syndicate)
- üìñ [Examples Repository](https://github.com/epam/aws-syndicate-examples)
- üéì [EPAM Training](https://learn.epam.com/)

## –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å Task 7 setup script

**setup-iam-task7.sh** (manual approach):
```bash
# 50+ —Å—Ç—Ä–æ–∫ –∫–æ–º–∞–Ω–¥ AWS CLI
# –†—É—á–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ IAM —Ä–æ–ª–∏
# –†—É—á–Ω–∞—è —É–ø–∞–∫–æ–≤–∫–∞ Lambda
# –†—É—á–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ API Gateway
```

**Syndicate** (declarative approach):
```bash
# deployment_resources.json (20 —Å—Ç—Ä–æ–∫)
syndicate build
syndicate deploy --bundle_name task7-v1
# –ì–æ—Ç–æ–≤–æ!
```

---

‚úÖ **–í—ã–≤–æ–¥**: Syndicate –∏–¥–µ–∞–ª–µ–Ω –¥–ª—è production deployments, AWS CLI –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –∏ –ø–æ–Ω–∏–º–∞–Ω–∏—è AWS –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã.
